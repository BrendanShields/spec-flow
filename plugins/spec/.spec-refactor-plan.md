# Spec v3.0: Big Bang Migration & Token Optimization Plan

**Status**: ğŸš§ In Progress
**Started**: 2025-10-31
**Target Release**: v3.0.0
**Strategy**: Parallel tracks with subagent automation

---

## ğŸ¯ Goals

1. **Rename**: spec â†’ spec (commands, skills, all references)
2. **Optimize**: 80% token reduction (50,000 â†’ 10,000 per workflow)
3. **Improve UX**: Single /spec command with intelligent routing
4. **Maintain Quality**: 90%+ skill activation accuracy

---

## ğŸ“Š Progress Overview

| Track | Status | Progress | ETA |
|-------|--------|----------|-----|
| **Track 1: Renaming** | ğŸš§ In Progress | 15% | Week 2 |
| **Track 2: Token Optimization** | ğŸš§ In Progress | 60% | Week 1 |
| **Track 3: Testing** | â¸ï¸ Blocked | 0% | Week 3 |

**Overall Progress**: 5/13 tasks complete (38%)

---

## ğŸ”„ Parallel Execution Tracks

### Track 1: Renaming & Rebranding

**Objective**: Transform all spec:* â†’ spec:* naming

#### Track 1A: Command Generation (skill-builder + slash-commands)
- [âœ…] Create /spec hub command with state caching
- [âœ…] Implement subcommand routing (init, generate, plan, tasks, implement)
- [âœ…] Add context-aware help system
- [âœ…] Implement lazy loading flags (--examples, --help, --verbose)

#### Track 1B: Skill Regeneration (skill-builder subagent)
- [ ] Regenerate spec:init (was spec:init)
- [âœ…] Regenerate spec:generate (was spec:specify) **COMPLETE**
- [ ] Regenerate spec:plan (was spec:plan)
- [ ] Regenerate spec:tasks (was spec:tasks)
- [ ] Regenerate spec:implement (was spec:implement)
- [ ] Regenerate spec:clarify (was spec:clarify)
- [ ] Regenerate spec:blueprint (was spec:blueprint)
- [ ] Regenerate spec:update (was spec:update)
- [ ] Regenerate spec:orchestrate (was spec:orchestrate)
- [ ] Regenerate spec:analyze (was spec:analyze)
- [ ] Regenerate spec:discover (was spec:discover)
- [ ] Regenerate spec:checklist (was spec:checklist)
- [ ] Regenerate spec:metrics (was spec:metrics)

#### Track 1C: File System Migration
- [ ] Rename directories: .claude/skills/spec-* â†’ spec-*
- [ ] Rename commands: .claude/commands/spec-*.md â†’ spec-*.md
- [ ] Update hooks.json references
- [ ] Update all internal cross-references

---

### Track 2: Token Optimization

**Objective**: Reduce token usage by 80%

#### Track 2A: Shared Resources
- [âœ…] Create .claude/skills/shared/ directory **COMPLETE**
- [âœ…] Create shared/integration-patterns.md (MCP docs) **COMPLETE**
- [âœ…] Create shared/workflow-patterns.md (common workflows) **COMPLETE**
- [âœ…] Create shared/state-management.md (state docs) **COMPLETE**
- [ ] Update all skills to reference shared resources

#### Track 2B: State Caching
- [âœ…] Implement state caching in /spec hub command **COMPLETE**
- [âœ…] Read state files once at hub level **COMPLETE**
- [âœ…] Pass cached state to skills via parameters **COMPLETE**
- [ ] Remove redundant state reads from individual skills

#### Track 2C: Progressive Disclosure
- [ ] Add --examples flag to load EXAMPLES.md
- [ ] Add --help flag to load REFERENCE.md
- [ ] Add --verbose flag for detailed output
- [ ] Optimize SKILL.md core content (target: <1,500 tokens each)

#### Track 2D: Content Deduplication
- [ ] Identify duplicate content across skills
- [ ] Move to shared resources
- [ ] Replace with cross-references
- [ ] Validate all references work

---

### Track 3: Testing & Validation

**Objective**: Ensure quality and performance targets

#### Testing Checklist
- [ ] Test /spec init command
- [ ] Test /spec generate command
- [ ] Test /spec plan command
- [ ] Test /spec tasks command
- [ ] Test /spec implement command
- [ ] Test full workflow end-to-end
- [ ] Validate skill activation accuracy (target: 90%+)
- [ ] Integration tests with MCP servers
- [ ] Performance benchmarks (compare v2.1 vs v3.0)

#### Validation Criteria
- [ ] All skills activate on intended phrases
- [ ] No false positives (<5%)
- [ ] Token usage reduced by 80%
- [ ] Workflow speed improved by 60%
- [ ] All documentation updated
- [ ] Migration guide complete

---

## ğŸš€ Automation Strategy

### Subagent Usage

| Subagent | Task | Status | Notes |
|----------|------|--------|-------|
| **skill-builder** | Regenerate 13 skills with spec:* naming | ğŸš§ Active | Optimize descriptions for discovery |
| **slash-commands** | Create /spec hub command | ğŸš§ Active | Implement intelligent routing |
| **Manual** | State caching implementation | â¸ï¸ Pending | Complex logic requires manual work |
| **Manual** | Integration testing | â¸ï¸ Pending | After tracks 1 & 2 complete |

---

## ğŸ“‹ Key Changes (Breaking)

| Component | v2.1 (Current) | v3.0 (New) | Breaking? |
|-----------|---------------|------------|-----------|
| Hub command | /spec | **/spec** | âœ… Yes |
| Commands | /spec-init, etc. | **/spec init** | âœ… Yes |
| Specify skill | spec:specify | **spec:generate** | âœ… Yes |
| Other skills | spec:* | **spec:** * | âœ… Yes |
| State directory | .spec-state/ | .spec-state/ | âŒ No (unchanged) |
| Memory directory | .spec-memory/ | .spec-memory/ | âŒ No (unchanged) |

---

## ğŸ“ˆ Success Metrics

| Metric | v2.1 Baseline | v3.0 Target | Current | Status |
|--------|---------------|-------------|---------|--------|
| Tokens per command | ~15,000 | ~2,250 | TBD | â¸ï¸ |
| Tokens per workflow | ~50,000 | ~10,000 | TBD | â¸ï¸ |
| Workflow speed | ~15 min | ~6 min | TBD | â¸ï¸ |
| Commands to learn | 8 | 1 | TBD | â¸ï¸ |
| Skill activation | ~80% | ~90% | TBD | â¸ï¸ |

---

## âš ï¸ Risks & Mitigations

| Risk | Likelihood | Impact | Mitigation | Status |
|------|------------|--------|------------|--------|
| Users break workflows | HIGH | HIGH | Migration guide + compatibility checker | â¸ï¸ Pending |
| Skills don't activate | MEDIUM | HIGH | Test activation patterns thoroughly | â¸ï¸ Pending |
| Performance regression | LOW | HIGH | Benchmark before/after | â¸ï¸ Pending |
| Documentation gaps | MEDIUM | MEDIUM | Comprehensive review process | â¸ï¸ Pending |

---

## ğŸ“… Timeline

### Week 1: Parallel Setup
- **Day 1-2**: Launch skill-builder and slash-commands subagents
- **Day 3-4**: Create shared resources, implement state caching
- **Day 5**: Review generated content, adjust as needed

### Week 2: Core Migration
- **Day 6-8**: Rename all files and directories
- **Day 9-10**: Update all references and documentation

### Week 3: Testing & Release
- **Day 11-13**: Integration testing and validation
- **Day 14-15**: Release preparation, final review
- **Day 15**: v3.0.0 release

---

## ğŸ“ Deliverables

### Code
- [ğŸš§] New /spec hub command with intelligent routing
- [ ] 13 regenerated skills with spec:* naming
- [ ] Shared resources directory with common docs
- [ ] State caching implementation
- [ ] Lazy loading flags (--examples, --help)

### Documentation
- [ ] Updated README.md
- [ ] Updated QUICK-START.md
- [ ] Updated USER-GUIDE.md
- [ ] New MIGRATION-GUIDE.md (v2.x â†’ v3.0)
- [ ] Release notes with breaking changes
- [ ] Developer documentation for subagents

### Testing
- [ ] Activation pattern tests (90%+ accuracy)
- [ ] Integration tests for full workflow
- [ ] Performance benchmarks
- [ ] Migration validation scripts

---

## ğŸ”— References

### Analysis Documents
- Comprehensive Analysis Report (from Plan agent)
- Token usage analysis (~50,000 â†’ ~10,000 target)
- Workflow optimization opportunities

### Related Files
- `.claude/commands/ğŸ‘».md` - Current hub command (v2.1)
- `.claude/skills/spec-*/SKILL.md` - Current skills
- `.spec-state/current-session.md` - State management
- `.spec-memory/WORKFLOW-PROGRESS.md` - Progress tracking

---

## ğŸ“ Communication

### User Updates
- [ ] Initial plan shared and approved âœ…
- [ ] Week 1 progress update (end of week)
- [ ] Week 2 progress update (end of week)
- [ ] Pre-release notification (day before)
- [ ] v3.0.0 release announcement

### Breaking Changes Notice
- âš ï¸ v3.0.0 is a breaking release
- ğŸ”§ Migration guide provided
- ğŸ“– All documentation updated
- ğŸ§ª Extensive testing before release

---

## ğŸ¯ Next Actions

### Immediate (Now)
1. âœ… Create this tracking document
2. ğŸš§ Launch skill-builder subagent to regenerate skills
3. ğŸš§ Launch slash-commands subagent to create /spec command
4. ğŸš§ Create shared resources directory
5. ğŸš§ Start state caching implementation

### Short-term (This Week)
- Complete skill regeneration (all 13 skills)
- Complete /spec command generation
- Implement shared resources
- Implement state caching

### Mid-term (Next Week)
- File system migration (rename all files)
- Update all references
- Documentation updates
- Testing preparation

### Long-term (Week 3)
- Integration testing
- Performance benchmarking
- Release preparation
- v3.0.0 release

---

**Last Updated**: 2025-10-31
**Updated By**: Claude (Spec v3.0 Migration)
**Next Review**: End of Week 1
