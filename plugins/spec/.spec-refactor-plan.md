# Spec v3.0: Big Bang Migration & Token Optimization Plan

**Status**: 🚧 In Progress
**Started**: 2025-10-31
**Target Release**: v3.0.0
**Strategy**: Parallel tracks with subagent automation

---

## 🎯 Goals

1. **Rename**: spec → spec (commands, skills, all references)
2. **Optimize**: 80% token reduction (50,000 → 10,000 per workflow)
3. **Improve UX**: Single /spec command with intelligent routing
4. **Maintain Quality**: 90%+ skill activation accuracy

---

## 📊 Progress Overview

| Track | Status | Progress | ETA |
|-------|--------|----------|-----|
| **Track 1: Renaming** | 🚧 In Progress | 15% | Week 2 |
| **Track 2: Token Optimization** | 🚧 In Progress | 60% | Week 1 |
| **Track 3: Testing** | ⏸️ Blocked | 0% | Week 3 |

**Overall Progress**: 5/13 tasks complete (38%)

---

## 🔄 Parallel Execution Tracks

### Track 1: Renaming & Rebranding

**Objective**: Transform all spec:* → spec:* naming

#### Track 1A: Command Generation (skill-builder + slash-commands)
- [✅] Create /spec hub command with state caching
- [✅] Implement subcommand routing (init, generate, plan, tasks, implement)
- [✅] Add context-aware help system
- [✅] Implement lazy loading flags (--examples, --help, --verbose)

#### Track 1B: Skill Regeneration (skill-builder subagent)
- [ ] Regenerate spec:init (was spec:init)
- [✅] Regenerate spec:generate (was spec:specify) **COMPLETE**
- [ ] Regenerate spec:plan (was spec:plan)
- [ ] Regenerate spec:tasks (was spec:tasks)
- [ ] Regenerate spec:implement (was spec:implement)
- [ ] Regenerate spec:clarify (was spec:clarify)
- [ ] Regenerate spec:blueprint (was spec:blueprint)
- [ ] Regenerate spec:update (was spec:update)
- [ ] Regenerate spec:orchestrate (was spec:orchestrate)
- [ ] Regenerate spec:analyze (was spec:analyze)
- [ ] Regenerate spec:discover (was spec:discover)
- [ ] Regenerate spec:checklist (was spec:checklist)
- [ ] Regenerate spec:metrics (was spec:metrics)

#### Track 1C: File System Migration
- [ ] Rename directories: .claude/skills/spec-* → spec-*
- [ ] Rename commands: .claude/commands/spec-*.md → spec-*.md
- [ ] Update hooks.json references
- [ ] Update all internal cross-references

---

### Track 2: Token Optimization

**Objective**: Reduce token usage by 80%

#### Track 2A: Shared Resources
- [✅] Create .claude/skills/shared/ directory **COMPLETE**
- [✅] Create shared/integration-patterns.md (MCP docs) **COMPLETE**
- [✅] Create shared/workflow-patterns.md (common workflows) **COMPLETE**
- [✅] Create shared/state-management.md (state docs) **COMPLETE**
- [ ] Update all skills to reference shared resources

#### Track 2B: State Caching
- [✅] Implement state caching in /spec hub command **COMPLETE**
- [✅] Read state files once at hub level **COMPLETE**
- [✅] Pass cached state to skills via parameters **COMPLETE**
- [ ] Remove redundant state reads from individual skills

#### Track 2C: Progressive Disclosure
- [ ] Add --examples flag to load EXAMPLES.md
- [ ] Add --help flag to load REFERENCE.md
- [ ] Add --verbose flag for detailed output
- [ ] Optimize SKILL.md core content (target: <1,500 tokens each)

#### Track 2D: Content Deduplication
- [ ] Identify duplicate content across skills
- [ ] Move to shared resources
- [ ] Replace with cross-references
- [ ] Validate all references work

---

### Track 3: Testing & Validation

**Objective**: Ensure quality and performance targets

#### Testing Checklist
- [ ] Test /spec init command
- [ ] Test /spec generate command
- [ ] Test /spec plan command
- [ ] Test /spec tasks command
- [ ] Test /spec implement command
- [ ] Test full workflow end-to-end
- [ ] Validate skill activation accuracy (target: 90%+)
- [ ] Integration tests with MCP servers
- [ ] Performance benchmarks (compare v2.1 vs v3.0)

#### Validation Criteria
- [ ] All skills activate on intended phrases
- [ ] No false positives (<5%)
- [ ] Token usage reduced by 80%
- [ ] Workflow speed improved by 60%
- [ ] All documentation updated
- [ ] Migration guide complete

---

## 🚀 Automation Strategy

### Subagent Usage

| Subagent | Task | Status | Notes |
|----------|------|--------|-------|
| **skill-builder** | Regenerate 13 skills with spec:* naming | 🚧 Active | Optimize descriptions for discovery |
| **slash-commands** | Create /spec hub command | 🚧 Active | Implement intelligent routing |
| **Manual** | State caching implementation | ⏸️ Pending | Complex logic requires manual work |
| **Manual** | Integration testing | ⏸️ Pending | After tracks 1 & 2 complete |

---

## 📋 Key Changes (Breaking)

| Component | v2.1 (Current) | v3.0 (New) | Breaking? |
|-----------|---------------|------------|-----------|
| Hub command | /spec | **/spec** | ✅ Yes |
| Commands | /spec-init, etc. | **/spec init** | ✅ Yes |
| Specify skill | spec:specify | **spec:generate** | ✅ Yes |
| Other skills | spec:* | **spec:** * | ✅ Yes |
| State directory | .spec-state/ | .spec-state/ | ❌ No (unchanged) |
| Memory directory | .spec-memory/ | .spec-memory/ | ❌ No (unchanged) |

---

## 📈 Success Metrics

| Metric | v2.1 Baseline | v3.0 Target | Current | Status |
|--------|---------------|-------------|---------|--------|
| Tokens per command | ~15,000 | ~2,250 | TBD | ⏸️ |
| Tokens per workflow | ~50,000 | ~10,000 | TBD | ⏸️ |
| Workflow speed | ~15 min | ~6 min | TBD | ⏸️ |
| Commands to learn | 8 | 1 | TBD | ⏸️ |
| Skill activation | ~80% | ~90% | TBD | ⏸️ |

---

## ⚠️ Risks & Mitigations

| Risk | Likelihood | Impact | Mitigation | Status |
|------|------------|--------|------------|--------|
| Users break workflows | HIGH | HIGH | Migration guide + compatibility checker | ⏸️ Pending |
| Skills don't activate | MEDIUM | HIGH | Test activation patterns thoroughly | ⏸️ Pending |
| Performance regression | LOW | HIGH | Benchmark before/after | ⏸️ Pending |
| Documentation gaps | MEDIUM | MEDIUM | Comprehensive review process | ⏸️ Pending |

---

## 📅 Timeline

### Week 1: Parallel Setup
- **Day 1-2**: Launch skill-builder and slash-commands subagents
- **Day 3-4**: Create shared resources, implement state caching
- **Day 5**: Review generated content, adjust as needed

### Week 2: Core Migration
- **Day 6-8**: Rename all files and directories
- **Day 9-10**: Update all references and documentation

### Week 3: Testing & Release
- **Day 11-13**: Integration testing and validation
- **Day 14-15**: Release preparation, final review
- **Day 15**: v3.0.0 release

---

## 📝 Deliverables

### Code
- [🚧] New /spec hub command with intelligent routing
- [ ] 13 regenerated skills with spec:* naming
- [ ] Shared resources directory with common docs
- [ ] State caching implementation
- [ ] Lazy loading flags (--examples, --help)

### Documentation
- [ ] Updated README.md
- [ ] Updated QUICK-START.md
- [ ] Updated USER-GUIDE.md
- [ ] New MIGRATION-GUIDE.md (v2.x → v3.0)
- [ ] Release notes with breaking changes
- [ ] Developer documentation for subagents

### Testing
- [ ] Activation pattern tests (90%+ accuracy)
- [ ] Integration tests for full workflow
- [ ] Performance benchmarks
- [ ] Migration validation scripts

---

## 🔗 References

### Analysis Documents
- Comprehensive Analysis Report (from Plan agent)
- Token usage analysis (~50,000 → ~10,000 target)
- Workflow optimization opportunities

### Related Files
- `.claude/commands/👻.md` - Current hub command (v2.1)
- `.claude/skills/spec-*/SKILL.md` - Current skills
- `.spec-state/current-session.md` - State management
- `.spec-memory/WORKFLOW-PROGRESS.md` - Progress tracking

---

## 📞 Communication

### User Updates
- [ ] Initial plan shared and approved ✅
- [ ] Week 1 progress update (end of week)
- [ ] Week 2 progress update (end of week)
- [ ] Pre-release notification (day before)
- [ ] v3.0.0 release announcement

### Breaking Changes Notice
- ⚠️ v3.0.0 is a breaking release
- 🔧 Migration guide provided
- 📖 All documentation updated
- 🧪 Extensive testing before release

---

## 🎯 Next Actions

### Immediate (Now)
1. ✅ Create this tracking document
2. 🚧 Launch skill-builder subagent to regenerate skills
3. 🚧 Launch slash-commands subagent to create /spec command
4. 🚧 Create shared resources directory
5. 🚧 Start state caching implementation

### Short-term (This Week)
- Complete skill regeneration (all 13 skills)
- Complete /spec command generation
- Implement shared resources
- Implement state caching

### Mid-term (Next Week)
- File system migration (rename all files)
- Update all references
- Documentation updates
- Testing preparation

### Long-term (Week 3)
- Integration testing
- Performance benchmarking
- Release preparation
- v3.0.0 release

---

**Last Updated**: 2025-10-31
**Updated By**: Claude (Spec v3.0 Migration)
**Next Review**: End of Week 1
